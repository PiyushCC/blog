---
layout: base.njk
---
{% set tocHtml = content | toc %}
<div class="post-page-layout{% if tocHtml %} post-page-layout--with-toc{% endif %}">
  <div class="post-main">
    <article class="post">
      <header>
        <div data-pagefind-body>
          <h1>{{ title }}</h1>
        </div>
        <div class="post-meta" data-pagefind-ignore="all">
          <time datetime="{{ date | date('YYYY-MM-DD') }}">{{ date | date('YYYY-MM-DD') }}</time>
          {% if category %}<span>{{ category }}</span>{% endif %}
          <span class="reading-time">{{ content | readingTime }}</span>
        </div>
      </header>
      <div class="post-content" data-pagefind-ignore="all">
        {{ content | safe }}
      </div>
      {% set prev = collections.posts | getPreviousCollectionItem %}
      {% set next = collections.posts | getNextCollectionItem %}
      {% if prev or next %}
      <nav class="prev-next" aria-label="Previous and next posts" data-pagefind-ignore="all">
        {% if prev %}
        <a href="{{ prev.url }}">← {{ prev.data.title }}</a>
        {% else %}
        <span></span>
        {% endif %}
        {% if next %}
        <a href="{{ next.url }}">{{ next.data.title }} →</a>
        {% else %}
        <span></span>
        {% endif %}
      </nav>
      {% endif %}
      {% set related = collections.posts | relatedPosts(page.url, tags, 3) %}
      {% if related.length %}
      <section class="related-posts" data-pagefind-ignore="all">
        <h3>Related by tag</h3>
        <ul>
          {% for post in related %}
          <li><a href="{{ post.url }}">{{ post.data.title }}</a></li>
          {% endfor %}
        </ul>
      </section>
      {% endif %}
      {% if site.giscusRepoId %}
      <section class="giscus-container" aria-label="Comments" data-pagefind-ignore="all">
        <div id="giscus-comments"></div>
        <script src="https://giscus.app/client.js" data-repo="{{ site.giscusRepo }}" data-repo-id="{{ site.giscusRepoId }}" data-category="{{ site.giscusCategory }}" data-category-id="{{ site.giscusCategoryId }}" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="bottom" data-theme="preferred_color_scheme" data-lang="en" crossorigin="anonymous" async></script>
      </section>
      {% endif %}
    </article>
  </div>
  {% if tocHtml %}
  <aside class="post-toc" aria-label="On this page">
    <div class="post-toc-inner">
      {{ tocHtml | safe }}
    </div>
  </aside>
  {% endif %}
</div>
